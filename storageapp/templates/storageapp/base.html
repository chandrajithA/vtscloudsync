{% load static %}
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>{% block title %}{% endblock %}</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="{% static 'css/common.css' %}">
    <link rel="stylesheet" href="{% static 'css/base.css' %}">

    {% block style %}
    {% endblock %}

</head>

<body>

<!-- HEADER -->
<div class="header">
    <div class="logoarea">
        <div class="logoimage">
            <img src="{% static 'images/cloud.png' %}" alt="logoimage">
        </div>
        <div class="logotext">CloudSync</div>

    </div>

    

    <form onsubmit="return false;" class="global-search">
        <div class="search-box">
        <input
            type="text"
           
            placeholder="Search files, folders..."
            
        >
        </div>
    </form>

    <div class="header-right">
        <div class="notification"><img src="{% static 'images/bell.png' %}" alt="" srcset=""><span>0</span></div>
        <div class="user-pill">{{ request.user.first_name|default:request.user.username }}</div>
    </div>
</div>

<!-- SIDEBAR -->
<div class="sidebar">
    <a href="{% url 'storageapp:dashboard' %}" class="nav-item {% if request.resolver_match.url_name == 'dashboard' %}active{% endif %}"><img src="{% static 'images/dashboard.png' %}" alt=""> Dashboard</a>
    <a href="{% url 'storageapp:upload_page' %}" class="nav-item {% if request.resolver_match.url_name == 'upload_page' %}active{% endif %}"><img src="{% static 'images/upload.png' %}" alt=""> Upload</a>
    <a href="{% url 'storageapp:shared_files' %}" class="nav-item {% if request.resolver_match.url_name == 'shared_files' %}active{% endif %}"><img src="{% static 'images/share.png' %}" alt=""> Shared</a>
    <a href="{% url 'storageapp:myfiles' %}" class="nav-item {% if request.resolver_match.url_name == 'myfiles' %}active{% endif %}"><img src="{% static 'images/myfile.png' %}" alt=""> My Files</a>
    <a href="{% url 'storageapp:trash' %}" class="nav-item {% if request.resolver_match.url_name == 'trash' %}active{% endif %}"><img src="{% static 'images/trash.png' %}" alt=""> Trash</a>
    <a href="{% url 'storageapp:settings' %}" class="nav-item {% if request.resolver_match.url_name == 'settings' %}active{% endif %}"><img src="{% static 'images/settings.png' %}" alt=""> Settings</a>
    <a href="{% url 'accounts:user_logout' %}" class="nav-item"><img src="{% static 'images/logout.png' %}" alt=""> Logout</a>

    <div class="storage-box">
    <strong>Storage</strong>

    <div class="progressbar">
    
</div>


</div>
</div>

<!-- MAIN CONTENT -->
<div class="main">
    {% block content %}
    {% endblock %}
</div>

<script>
const searchInput = document.getElementById("globalSearch");
let debounceTimer = null;

if (searchInput) {
    searchInput.addEventListener("input", function () {
        clearTimeout(debounceTimer);

        debounceTimer = setTimeout(() => {
            const query = searchInput.value.trim();

            // Redirect to My Files if not already there
            if (!window.location.pathname.includes("/user/myfiles")) {
                window.location.href = `/user/myfiles/?q=${encodeURIComponent(query)}`;
                return;
            }

            fetch(`/user/myfiles/search/?q=${encodeURIComponent(query)}`)
                .then(res => res.text())
                .then(html => {
                    const container = document.getElementById("filesContainer");
                    if (container) container.innerHTML = html;
                });
        }, 300);
    });
}
<script>
const searchInput = document.getElementById("globalSearch");
let debounceTimer = null;

if (searchInput) {
    searchInput.addEventListener("input", function () {
        clearTimeout(debounceTimer);

        debounceTimer = setTimeout(() => {
            const query = searchInput.value.trim();

            // Redirect to My Files if not already there
            if (!window.location.pathname.includes("/user/myfiles")) {
                window.location.href = `/user/myfiles/?q=${encodeURIComponent(query)}`;
                return;
            }

            fetch(`/user/myfiles/search/?q=${encodeURIComponent(query)}`)
                .then(res => res.text())
                .then(html => {
                    const container = document.getElementById("filesContainer");
                    if (container) container.innerHTML = html;
                });
        }, 300);
    });
}
</script>
    
    {% block script %}
    {% endblock %}
    

</body>
</html>
